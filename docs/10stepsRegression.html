<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The 10 Steps Papers Reproduced - Zuur &amp; Ieno’s 10 steps</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-binding-2.2.1/leaflet.js"></script>
<script src="site_libs/rglWebGL-binding-1.2.8/rglWebGL.js"></script>
<link href="site_libs/rglwidgetClass-1.2.8/rgl.css" rel="stylesheet">
<script src="site_libs/rglwidgetClass-1.2.8/rglClass.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/utils.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/buffer.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/subscenes.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/shaders.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/shadersrc.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/textures.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/projection.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/mouse.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/init.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/pieces.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/draw.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/controls.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/selection.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/rglTimer.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/pretty.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/axes.src.js"></script>
<script src="site_libs/rglwidgetClass-1.2.8/animation.src.js"></script>
<script src="site_libs/CanvasMatrix4-1.2.8/CanvasMatrix.src.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">The 10 Steps Papers Reproduced</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./10stepsRegression.html" rel="" target="" aria-current="page">
 <span class="menu-text">10 steps for Regression Analyses</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./10stepsDataExploration.html" rel="" target="">
 <span class="menu-text">10 steps for Data Exploration</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#step-1-state-appropriate-questions" id="toc-step-1-state-appropriate-questions" class="nav-link active" data-scroll-target="#step-1-state-appropriate-questions">Step 1: State appropriate questions</a></li>
  <li><a href="#step-2-visualize-the-experimental-design" id="toc-step-2-visualize-the-experimental-design" class="nav-link" data-scroll-target="#step-2-visualize-the-experimental-design">Step 2: Visualize the experimental design</a></li>
  <li><a href="#step-3-conduct-data-exploration" id="toc-step-3-conduct-data-exploration" class="nav-link" data-scroll-target="#step-3-conduct-data-exploration">Step 3: Conduct data exploration</a></li>
  <li><a href="#step-4-identify-the-dependency-structure-in-the-data" id="toc-step-4-identify-the-dependency-structure-in-the-data" class="nav-link" data-scroll-target="#step-4-identify-the-dependency-structure-in-the-data">Step 4: Identify the dependency structure in the data</a></li>
  <li><a href="#step-5-present-the-statistical-model" id="toc-step-5-present-the-statistical-model" class="nav-link" data-scroll-target="#step-5-present-the-statistical-model">Step 5: Present the statistical model</a></li>
  <li><a href="#step-6-fit-the-model" id="toc-step-6-fit-the-model" class="nav-link" data-scroll-target="#step-6-fit-the-model">Step 6: Fit the model</a></li>
  <li><a href="#step-7-validate-the-model" id="toc-step-7-validate-the-model" class="nav-link" data-scroll-target="#step-7-validate-the-model">Step 7: Validate the model</a></li>
  <li><a href="#step-8-interpret-and-present-the-numerical-output-of-the-model" id="toc-step-8-interpret-and-present-the-numerical-output-of-the-model" class="nav-link" data-scroll-target="#step-8-interpret-and-present-the-numerical-output-of-the-model">Step 8: Interpret and present the numerical output of the model</a></li>
  <li><a href="#step-9-create-a-visual-representation-of-the-model" id="toc-step-9-create-a-visual-representation-of-the-model" class="nav-link" data-scroll-target="#step-9-create-a-visual-representation-of-the-model">Step 9: Create a visual representation of the model</a></li>
  <li><a href="#step-10-simulate-from-the-model" id="toc-step-10-simulate-from-the-model" class="nav-link" data-scroll-target="#step-10-simulate-from-the-model">Step 10: Simulate from the model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Zuur &amp; Ieno’s 10 steps</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This website in a reproducible exploration of “<a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.12577">A protocol for conducting and presenting results of regression-type analyses</a>” by Alain F. Zuur, and Elena N. Ieno.</p>
<p>The 10 steps are all first presented in figure 1 of the paper:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://besjournals.onlinelibrary.wiley.com/cms/asset/17c3d76c-f2e6-4e2a-a117-581a303cdaef/mee312577-fig-0001-m.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">The 10 steps of regression analyses.</figcaption>
</figure>
</div>
<p>The focus of the 10 steps on on linear modelling of the type <strong>GLM, GLMM</strong> etc and uses R although it generalizes to other languages.</p>
<section id="accessing-data-and-code-for-reproducibility" class="level4">
<h4 class="anchored" data-anchor-id="accessing-data-and-code-for-reproducibility">Accessing data and code for reproducibility</h4>
<p>The paper provides data and code on Dryad but is not set up for interactive report-style reproducibility with package versioning. To fix that, I used a quarto document with <code>renv</code> to produce this website. In order to reproduce the analysis here, you can clone <a href="https://github.com/VLucet/ZuurIeno10steps">the repository</a> in <a href="https://happygitwithr.com/new-github-first#new-rstudio-project-via-git">RStudio</a>, install the <a href="https://rstudio.github.io/renv/articles/renv.html"><code>renv</code></a> package, run <code>renv::restore()</code> and you should be good to go for running the quarto notebook!</p>
<p>I had to make some changes to the packages used. Let’s load what we will need now. Packages <code>maptools</code> and <code>rgdal</code> are deprecated as far as I can tell, and <code>sp</code> is just not recommendable for forward compatibility in 2024.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Necessary packages from original code</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)  </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Recommended by the authors but outdated</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># library(maptools) =&gt; We will use other packages</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># library(sp) =&gt; We won't need it with sf</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rgdal) =&gt; We won't need it with sf</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Using sf</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Other additionnal packages to improve upon the provided code</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># We also setup for rgl plots in the webpage</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(equatiomatic)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgl) ; knitr<span class="sc">::</span>knit_hooks<span class="sc">$</span><span class="fu">set</span>(<span class="at">webgl =</span> hook_webgl)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In order to access the data and code, we would ideally use a package like <a href="https://github.com/ropensci/rdryad"><code>rdryad</code></a> to do so, but I have been getting nowhere with it. It is probably broken as it is soon to be superseded by the <a href="https://github.com/ropenscilabs/deposits"><code>deposits</code></a> package. If I forget to update this website with the latest <a href="https://github.com/ropenscilabs/deposits/issues/41"><code>deposits</code> API</a>, feel free the <a href="https://github.com/VLucet/ZuurIeno10steps/issues">file an issue</a>.</p>
<p>In the meantime, let’s download the files one by one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the file urls and destination files names &amp; names</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>base_dryad_url <span class="ot">&lt;-</span> <span class="st">"https://datadryad.org/stash/downloads/file_stream/"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>file_url_list <span class="ot">&lt;-</span> <span class="fu">paste0</span>(base_dryad_url, <span class="fu">c</span>(<span class="dv">37547</span><span class="sc">:</span><span class="dv">37550</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>files_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"monkeys.txt"</span>, <span class="st">"owls.txt"</span>, <span class="st">"oystercatchers.txt"</span>, <span class="st">"zurr_iena_2016.R"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>files_paths_list <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"data/"</span>, <span class="dv">3</span>), <span class="st">"scripts/"</span>), files_names)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># If the file exists already, do not download it</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>ret <span class="ot">&lt;-</span> <span class="fu">mapply</span>(\(file_url, file_path) {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) <span class="fu">download.file</span>(file_url, <span class="at">destfile =</span>  file_path)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>}, file_url_list, files_paths_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can take a look at the code in the scripts directory, we will be copying code from there into this document. Now, let’s load the data properly before we get anything else done.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Owls <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"owls.txt"</span>), </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dec =</span> <span class="st">"."</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># SiblingNegotiation is too long....use shorter name:</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>Owls<span class="sc">$</span>NCalls <span class="ot">&lt;-</span> Owls<span class="sc">$</span>SiblingNegotiation</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's look at it</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Owls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Nest"               "Xcoord"             "Ycoord"            
 [4] "FoodTreatment"      "SexParent"          "ArrivalTime"       
 [7] "SiblingNegotiation" "BroodSize"          "NegPerChick"       
[10] "Date"               "Day"                "Month"             
[13] "NCalls"            </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Owls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   599 obs. of  13 variables:
 $ Nest              : chr  "AutavauxTV" "AutavauxTV" "AutavauxTV" "AutavauxTV" ...
 $ Xcoord            : int  556216 556216 556216 556216 556216 556216 556216 556216 556216 556216 ...
 $ Ycoord            : int  188756 188756 188756 188756 188756 188756 188756 188756 188756 188756 ...
 $ FoodTreatment     : chr  "Deprived" "Deprived" "Deprived" "Deprived" ...
 $ SexParent         : chr  "Male" "Male" "Male" "Male" ...
 $ ArrivalTime       : num  22.2 22.5 22.6 22.6 22.6 ...
 $ SiblingNegotiation: int  4 2 2 2 2 18 18 3 3 3 ...
 $ BroodSize         : int  5 5 5 5 5 5 5 5 5 5 ...
 $ NegPerChick       : num  0.8 0.4 0.4 0.4 0.4 3.6 3.6 0.6 0.6 0.6 ...
 $ Date              : chr  "12/07/97" "12/07/97" "12/07/97" "12/07/97" ...
 $ Day               : int  12 12 12 12 12 12 12 12 12 12 ...
 $ Month             : int  7 7 7 7 7 7 7 7 7 7 ...
 $ NCalls            : int  4 2 2 2 2 18 18 3 3 3 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Owls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Nest Xcoord Ycoord FoodTreatment SexParent ArrivalTime
1 AutavauxTV 556216 188756      Deprived      Male       22.25
2 AutavauxTV 556216 188756      Deprived      Male       22.53
3 AutavauxTV 556216 188756      Deprived      Male       22.56
4 AutavauxTV 556216 188756      Deprived      Male       22.61
5 AutavauxTV 556216 188756      Deprived      Male       22.65
6 AutavauxTV 556216 188756      Deprived      Male       22.76
  SiblingNegotiation BroodSize NegPerChick     Date Day Month NCalls
1                  4         5         0.8 12/07/97  12     7      4
2                  2         5         0.4 12/07/97  12     7      2
3                  2         5         0.4 12/07/97  12     7      2
4                  2         5         0.4 12/07/97  12     7      2
5                  2         5         0.4 12/07/97  12     7      2
6                 18         5         3.6 12/07/97  12     7     18</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>OC <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"oystercatchers.txt"</span>), </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dec =</span> <span class="st">"."</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's look at it</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(OC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ShellLength" "Month"       "FeedingType" "FeedingPlot"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(OC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   197 obs. of  4 variables:
 $ ShellLength: num  1.9 2.16 2.17 2.34 2.2 2.2 1.92 2.11 2.17 2.41 ...
 $ Month      : chr  "Dec" "Dec" "Dec" "Dec" ...
 $ FeedingType: chr  "Hammerers" "Hammerers" "Stabbers" "Hammerers" ...
 $ FeedingPlot: chr  "B" "B" "B" "B" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(OC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ShellLength Month FeedingType FeedingPlot
1        1.90   Dec   Hammerers           B
2        2.16   Dec   Hammerers           B
3        2.17   Dec    Stabbers           B
4        2.34   Dec   Hammerers           B
5        2.20   Dec    Stabbers           B
6        2.20   Dec   Hammerers           B</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Monkeys <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"monkeys.txt"</span>), </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's look at it</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Monkeys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "SubordinateGrooms" "DominantGrooms"    "RankDifference"   
 [4] "Relatedness"       "GroomSymmetry"     "Time"             
 [7] "FocalHour"         "FocalGroomer"      "Receiver"         
[10] "GroupSize"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Monkeys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1674 obs. of  10 variables:
 $ SubordinateGrooms: chr  "yes" "yes" "yes" "yes" ...
 $ DominantGrooms   : chr  "no" "yes" "yes" "no" ...
 $ RankDifference   : num  0.697 0.632 0.169 0.378 0.511 ...
 $ Relatedness      : num  0.224 0.682 0.707 0.291 0.453 ...
 $ GroomSymmetry    : int  1 1 0 1 1 1 0 1 1 1 ...
 $ Time             : num  4.19 5.6 6.16 6.98 2.85 ...
 $ FocalHour        : int  71 72 72 73 74 75 75 75 75 75 ...
 $ FocalGroomer     : chr  "ade" "vic" "vic" "pre" ...
 $ Receiver         : chr  "ban" "yao" "pre" "nai" ...
 $ GroupSize        : chr  "large" "large" "large" "large" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Monkeys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  SubordinateGrooms DominantGrooms RankDifference Relatedness GroomSymmetry
1               yes             no      0.6969321   0.2238303             1
2               yes            yes      0.6324555   0.6823489             1
3               yes            yes      0.1690309   0.7071068             0
4               yes             no      0.3779645   0.2913760             1
5               yes            yes      0.5107539   0.4529901             1
6               yes            yes      0.2948839   0.4539824             1
      Time FocalHour FocalGroomer Receiver GroupSize
1 4.186111        71          ade      ban     large
2 5.601667        72          vic      yao     large
3 6.164167        72          vic      pre     large
4 6.976111        73          pre      nai     large
5 2.850556        74          dys      ver     small
6 8.605278        75          pox      ecz     small</code></pre>
</div>
</div>
</section>
<section id="step-1-state-appropriate-questions" class="level3">
<h3 class="anchored" data-anchor-id="step-1-state-appropriate-questions">Step 1: State appropriate questions</h3>
<p>The key idea is to have the salient question of the analysis in mind at the start, and formulate them properly. The example here is a study on the “vocal behavior of barn owl siblings” with a N = 28. The hypothesis is that food availability will influence “sibling negotiation”, proxied by the number of calls in the nest, sampled with microphones. Half the nests get extra food (treatment: satiated) and the other half is starved (treatment: deprived ; surprisingly no control?).</p>
<p>The 3 covariates are <em>time</em>, <em>food treatment (satiated or deprived)</em> and <em>sex of parent.</em> The question is :</p>
<ul>
<li>Does the relationship between sibling negotiation and sex of the parent differ with food treatment, and does the effect of time on sibling negotiation differ with food treatment?</li>
</ul>
<p>Note that the question contains the 3 terms and expected interactions.</p>
<p>The authors warn against breaking down the questions into smaller questions such as “Is there an effect of sex of the parent?”, as “A potential problem with this approach is that the residuals of one model may show patterns when compared with the covariates not used in that model, which invalidates the model assumptions.”</p>
<p>I find this a little surprising because I was taught to build simple models before complex ones, and would naturally work with simpler single covariate models first.</p>
</section>
<section id="step-2-visualize-the-experimental-design" class="level3">
<h3 class="anchored" data-anchor-id="step-2-visualize-the-experimental-design">Step 2: Visualize the experimental design</h3>
<p>This step is simple yet sometimes overlooked: visualize the sampling protocol and experimental design preferably with the help of a map.</p>
<p>Below we use the <code>sf</code> package to parse the data as spatial data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse the dataframe as a sf object with the proper projection, and reproject as</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># WGS 84 CRS (LAT / LONG)</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Owls_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(Owls, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"Xcoord"</span>, <span class="st">"Ycoord"</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>WGS84     <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(<span class="st">"+proj=longlat +datum=WGS84"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>projSWISS <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(<span class="st">"+init=epsg:21781"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in CPL_crs_from_input(x): GDAL Message 1: +init=epsg:XXXX syntax is
deprecated. It might return a CRS with a non-EPSG compliant axis order.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(Owls_sf) <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(projSWISS)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>Owls_sf_tmp <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(Owls_sf, WGS84)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>Owls_sf_wgs84 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Owls_sf_tmp, <span class="fu">st_coordinates</span>(Owls_sf_tmp))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's look at it</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Owls_sf_wgs84)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 13 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6.864574 ymin: 46.84849 xmax: 6.864574 ymax: 46.84849
Geodetic CRS:  +proj=longlat +datum=WGS84
        Nest FoodTreatment SexParent ArrivalTime SiblingNegotiation BroodSize
1 AutavauxTV      Deprived      Male       22.25                  4         5
2 AutavauxTV      Deprived      Male       22.53                  2         5
3 AutavauxTV      Deprived      Male       22.56                  2         5
4 AutavauxTV      Deprived      Male       22.61                  2         5
5 AutavauxTV      Deprived      Male       22.65                  2         5
6 AutavauxTV      Deprived      Male       22.76                 18         5
  NegPerChick     Date Day Month NCalls        X        Y
1         0.8 12/07/97  12     7      4 6.864574 46.84849
2         0.4 12/07/97  12     7      2 6.864574 46.84849
3         0.4 12/07/97  12     7      2 6.864574 46.84849
4         0.4 12/07/97  12     7      2 6.864574 46.84849
5         0.4 12/07/97  12     7      2 6.864574 46.84849
6         3.6 12/07/97  12     7     18 6.864574 46.84849
                   geometry
1 POINT (6.864574 46.84849)
2 POINT (6.864574 46.84849)
3 POINT (6.864574 46.84849)
4 POINT (6.864574 46.84849)
5 POINT (6.864574 46.84849)
6 POINT (6.864574 46.84849)</code></pre>
</div>
</div>
<p>The code suggests to write the points as a .kml file to open in Google Earth.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the points as kml, wich you can open in google earth</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>owls_kml_file <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"Owls_wgs84.kml"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(owls_kml_file)) {</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_write</span>(Owls_sf_wgs84, </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>           owls_kml_file, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">driver =</span> <span class="st">"kml"</span>, <span class="at">delete_dsn =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code relied <code>ggmap</code>, which makes an API request to Google maps. Of course, in 2024 we are required to use an API key for that. As an alternative I suggest <code>leaflet</code> which is more likely to work in the future and does not require to mess with API keys.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(Owls_sf_wgs84) <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span>  <span class="co"># Add default OpenStreetMap map tiles</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-431f7307704174f82127" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-431f7307704174f82127">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[[46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.8484935819107,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.77155440206464,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.94234904650907,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.87870621795681,46.88618885324772,46.88618885324772,46.88618885324772,46.88618885324772,46.88618885324772,46.88618885324772,46.88618885324772,46.88618885324772,46.88618885324772,46.88618885324772,46.83388227824464,46.83388227824464,46.83388227824464,46.83388227824464,46.83388227824464,46.83388227824464,46.83388227824464,46.83388227824464,46.83388227824464,46.83388227824464,46.83388227824464,46.83388227824464,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.79235132648381,46.87327868450894,46.87327868450894,46.87327868450894,46.87327868450894,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.79474464380153,46.85796945718111,46.85796945718111,46.85796945718111,46.85796945718111,46.85796945718111,46.85796945718111,46.85796945718111,46.85796945718111,46.85796945718111,46.85796945718111,46.89399744574284,46.89399744574284,46.89399744574284,46.89399744574284,46.89399744574284,46.89399744574284,46.89399744574284,46.89399744574284,46.89399744574284,46.89399744574284,46.89399744574284,46.89399744574284,46.89399744574284,46.89399744574284,46.89399744574284,46.74120274489125,46.74120274489125,46.74120274489125,46.74120274489125,46.74120274489125,46.74120274489125,46.74120274489125,46.74120274489125,46.74120274489125,46.74120274489125,46.74120274489125,46.74120274489125,46.74120274489125,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.90357450321446,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.87096141572227,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.71566977315873,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.82958912501409,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.75877163978134,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.81736348192928,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.7912464693961,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.85356529687622,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.83481339515575,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.85380035947002,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.81241437497044,46.83633450917069,46.83633450917069,46.83633450917069,46.83633450917069,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.89169586049928,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.7670721770665,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038,46.79694202399038],[6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.864574123584312,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.880923328768465,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.999745079036913,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.940457755494396,6.904306771686914,6.904306771686914,6.904306771686914,6.904306771686914,6.904306771686914,6.904306771686914,6.904306771686914,6.904306771686914,6.904306771686914,6.904306771686914,6.957350023398408,6.957350023398408,6.957350023398408,6.957350023398408,6.957350023398408,6.957350023398408,6.957350023398408,6.957350023398408,6.957350023398408,6.957350023398408,6.957350023398408,6.957350023398408,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.940930766086385,6.885087096515676,6.885087096515676,6.885087096515676,6.885087096515676,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.831537740673612,6.960976335953401,6.960976335953401,6.960976335953401,6.960976335953401,6.960976335953401,6.960976335953401,6.960976335953401,6.960976335953401,6.960976335953401,6.960976335953401,6.936116567549695,6.936116567549695,6.936116567549695,6.936116567549695,6.936116567549695,6.936116567549695,6.936116567549695,6.936116567549695,6.936116567549695,6.936116567549695,6.936116567549695,6.936116567549695,6.936116567549695,6.936116567549695,6.936116567549695,6.88085845129366,6.88085845129366,6.88085845129366,6.88085845129366,6.88085845129366,6.88085845129366,6.88085845129366,6.88085845129366,6.88085845129366,6.88085845129366,6.88085845129366,6.88085845129366,6.88085845129366,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,7.161744970500916,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.908577055897186,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.848124374848234,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.847789693328965,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.897718872306347,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.867081940583485,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,6.803679479589161,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,7.036543588526515,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.93142717232189,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.909087411151645,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.831967066145816,6.872359407555015,6.872359407555015,6.872359407555015,6.872359407555015,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.981342908268009,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.924381418289919,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351,6.743749842240351],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[46.71566977315873,46.94234904650907],"lng":[6.743749842240351,7.161744970500916]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>For a more publication-oriented map with <code>ggmap</code> I would recommend using the stadiamap API.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I suppress the API message</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>glgmap <span class="ot">&lt;-</span> <span class="fu">suppressMessages</span>(<span class="fu">get_stadiamap</span>(<span class="fu">c</span>(<span class="fl">6.7</span>, <span class="fl">46.70</span>, <span class="fl">7.2</span>, <span class="fl">46.96</span>)))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>p_ggmap <span class="ot">&lt;-</span> <span class="fu">ggmap</span>(glgmap) <span class="sc">+</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(X, Y),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> Owls_sf_wgs84,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Longitude"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Latitude"</span>) <span class="sc">+</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>p_ggmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="10stepsRegression_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also do a simple <code>sf</code> + <code>ggplot</code> plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>p_simple <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Owls_sf_wgs84) <span class="sc">+</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Longitude"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Latitude"</span>) <span class="sc">+</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>p_simple</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="10stepsRegression_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Finally, the code suggest another two plots that are not in the paper, but are useful. The first time is a plot of the time series.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>p_series <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Arrival time"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Number of calls"</span>) <span class="sc">+</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span> <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Owls_sf_wgs84,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> ArrivalTime,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> NCalls,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> FoodTreatment),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> Owls_sf_wgs84,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> ArrivalTime,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> NCalls,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> FoodTreatment,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> FoodTreatment)) <span class="sc">+</span> </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Nest, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>p_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="10stepsRegression_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>The second shows how sampling unfolds across space and time, but I find the plot a little unwieldy as it facets multiple maps.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We parse the date column as a proper date</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>Owls_sf_wgs84<span class="sc">$</span>Date_parsed <span class="ot">&lt;-</span> <span class="fu">as_date</span>(Owls_sf_wgs84<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">"%d/%m/%y"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>p_ggmap_facet <span class="ot">&lt;-</span> <span class="fu">ggmap</span>(glgmap) <span class="sc">+</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(X, Y),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> Owls_sf_wgs84,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Longitude"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Latitude"</span>) <span class="sc">+</span> </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span> </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Date_parsed) </span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>p_ggmap_facet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="10stepsRegression_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="step-3-conduct-data-exploration" class="level3">
<h3 class="anchored" data-anchor-id="step-3-conduct-data-exploration">Step 3: Conduct data exploration</h3>
<p>There is another even older Zurr et al.&nbsp;paper for the <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.12577#mee312577-bib-0040">10 steps of data exploration</a>. The first figure of that paper gives you the gist of the protocol (see the other page on this website to reproduce the paper).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://besjournals.onlinelibrary.wiley.com/cms/asset/890dd91b-444e-430b-b41b-c7edee6653fb/mee3_1_f1.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">The 10 steps for data exploration.</figcaption>
</figure>
</div>
<p>We now move from owls to oystercatchers. The study related the length of clams preyed upon and the feeding behavior of oystercatchers, accross time and space. The authors describe how the design suggests a 3-way interaction term that would in practicality only be driven by a couple of data points. The following plot shows that in location A in December, there were only two observations, both showing the same value. Note that I modified the plot to add colors to those problematic points to make the visualization clearer</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a color column</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>OC<span class="sc">$</span>color_pt <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(OC<span class="sc">$</span>Month <span class="sc">==</span> <span class="st">"Dec"</span> <span class="sc">&amp;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                        OC<span class="sc">$</span>FeedingType <span class="sc">==</span> <span class="st">"Stabbers"</span> <span class="sc">&amp;</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                        OC<span class="sc">$</span>FeedingPlot <span class="sc">==</span> <span class="st">"A"</span>, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"red"</span>, <span class="st">"grey"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Here is the code for Figure 3</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>p_OC <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Feeding type"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Shell length (mm)"</span>) <span class="sc">+</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> OC,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> FeedingType, <span class="at">y =</span> ShellLength),</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> OC<span class="sc">$</span>color_pt,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">03</span>),</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Month <span class="sc">~</span> FeedingPlot,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">"fixed"</span>) <span class="sc">+</span> </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span> </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>,</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">angle =</span> <span class="dv">20</span>),</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>,</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">colour =</span> <span class="st">"black"</span>,</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">angle =</span> <span class="dv">0</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>p_OC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="10stepsRegression_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You should spend a good amount of time on data exploration. It will also help you identify data quality issues and encoding errors.</p>
<p>Note that it is sometimes useful to tabulate data across levels of a given factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(OC<span class="sc">$</span>Month, OC<span class="sc">$</span>FeedingPlot, OC<span class="sc">$</span>FeedingType)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, ,  = Hammerers

     
       A  B  C
  Dec 17 14 26
  Jan 43 31 34

, ,  = Stabbers

     
       A  B  C
  Dec  2  5 15
  Jan  4  3  3</code></pre>
</div>
</div>
</section>
<section id="step-4-identify-the-dependency-structure-in-the-data" class="level3">
<h3 class="anchored" data-anchor-id="step-4-identify-the-dependency-structure-in-the-data">Step 4: Identify the dependency structure in the data</h3>
<p>The authors warn that it is rare to find a dataset without dependency structures. They advise GLMM as a way to deal with pseudoreplicated data (relying on pooling as a way to properly model dependencies between, say, sampling locations etc..).</p>
<p>We now move on to the baboon dataset. I think it is the same dataset used in Statistical Rethinking for teaching multilevel modelling. The design: the researchers are interested in understanding grooming behavior between baboons. Baboon may hold different ranks within the troop (represented as a value between 0 and 1). Some 60 baboons are sampled multiple times, for an hour at a time, its grooming behavior recorded, making the receiver of the behavior another layer of dependency. This pseudoreplication structure requires a mixed-effects model with random effects (two-way nested AND crossed). The structure looks like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://besjournals.onlinelibrary.wiley.com/cms/asset/b2fe00b8-9877-4106-983b-2285c5dd480e/mee312577-fig-0004-m.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Baboon dataset structure</figcaption>
</figure>
</div>
<p>The authors suggest to properly report the structure. Personally I love seeing, in papers, when both a graphical, a textual AND a mathematical description is given.</p>
<p>The textual description for baboon and owl data:</p>
<ul>
<li><p>This data set consists of multiple observations of rank differences of a given baboon and receivers within a focal hour, along with multiple observations of a given receiver. We therefore applied a mixed-effects model with the random effect <em>focal hour</em> nested within the random effect <em>baboon</em> and a crossed random effect <em>receiver</em></p></li>
<li><p>We sampled each nest multiple times and therefore applied a GLMM in which <em>nest</em> is used as random intercept, as this models a dependency structure among sibling negotiation observations of the same nest</p></li>
</ul>
</section>
<section id="step-5-present-the-statistical-model" class="level3">
<h3 class="anchored" data-anchor-id="step-5-present-the-statistical-model">Step 5: Present the statistical model</h3>
<p>Speaking of mathematical description, this step is where the authors suggest this is given and stated clearly, under the form of an equation. Here is what it would look like for the owl data:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://besjournals.onlinelibrary.wiley.com/cms/asset/ce92caf3-66eb-460f-91d4-66962d9cf7d9/mee312577-math-0001.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Equation describing the owl data model</figcaption>
</figure>
</div>
<p>One of the key element in this is how the error structure of the data is stated clearly: here the count of calls is modelled as a Poisson distribution. It shows the log link function and how the model is clearly defined. The authors give further advice for how to explain choices of distributions.</p>
<p>For the baboon data:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://besjournals.onlinelibrary.wiley.com/cms/asset/a3750982-7432-4000-beb0-f17477776b03/mee312577-math-0002.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Equation describing the baboon data model</figcaption>
</figure>
</div>
<p>If only all papers when to that length in describing their models (although I am definitely guilty of omitting details as well). The amazing package <a href="https://datalorax.github.io/equatiomatic/index.html"><code>equatiomatic</code></a> makes this easier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Although we will look at the model formulation at the next step in greater</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># details, let's try and use it here with equationmatic</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(NCalls <span class="sc">~</span> FoodTreatment <span class="sc">+</span> ArrivalTime <span class="sc">+</span> SexParent <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                     FoodTreatment <span class="sc">:</span> SexParent <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                     FoodTreatment <span class="sc">:</span> ArrivalTime <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                     (<span class="dv">1</span> <span class="sc">|</span> Nest),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> poisson,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> Owls)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_eq</span>(M1, <span class="at">wrap =</span> <span class="cn">TRUE</span>, <span class="at">terms_per_line =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\begin{aligned}
  \operatorname{NCalls}_{i}  &amp;\sim \operatorname{Poisson}(\lambda_i) \\
    \log(\lambda_i) &amp;=\alpha_{j[i]}\ + \\
&amp;\quad \beta_{1}(\operatorname{FoodTreatment}_{\operatorname{Satiated}})\ + \\
&amp;\quad \beta_{2}(\operatorname{ArrivalTime})\ + \\
&amp;\quad \beta_{3}(\operatorname{SexParent}_{\operatorname{Male}})\ + \\
&amp;\quad \beta_{4}(\operatorname{FoodTreatment}_{\operatorname{Satiated}} \times \operatorname{SexParent}_{\operatorname{Male}})\ + \\
&amp;\quad \beta_{5}(\operatorname{ArrivalTime} \times \operatorname{FoodTreatment}_{\operatorname{Satiated}}) \\
    \alpha_{j}  &amp;\sim N \left(\mu_{\alpha_{j}}, \sigma^2_{\alpha_{j}} \right)
    \text{, for Nest j = 1,} \dots \text{,J}
\end{aligned}
\]</span></p>
</div>
</div>
</section>
<section id="step-6-fit-the-model" class="level3">
<h3 class="anchored" data-anchor-id="step-6-fit-the-model">Step 6: Fit the model</h3>
<p>The authors first remind that it is important to say what software was used to fit the model, directly in the text. They add details as to how to report a MCMC analysis. This section of the paper is not very verbose and could have been expanded to talk about how versions of packages can be very relevant to the fitted results. Also, the paper could have discussed how fitted models are stored and conserved (with rds files) and implications of all this kind of stuff for the ability of future readers to make sense of the model.</p>
<p>One note concerning the owl dataset: in the code, the authors mention that the response variable should probably be transformed (but for some reason they do not show the process). They also mention that brood size should probably be used an offset in the model - but did not want to confuse readers of the paper with it, at the risk of confusing readers of the code by not explaining why and how the offset is needed here.</p>
<p>Let’s see the model again (note the additional code for the offset, if you want, but we won’t use it for the sake of consistency with the paper).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For the offset we need:</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>Owls<span class="sc">$</span>LogBroodSize <span class="ot">&lt;-</span> <span class="fu">log</span>(Owls<span class="sc">$</span>BroodSize)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(NCalls <span class="sc">~</span> FoodTreatment <span class="sc">+</span> ArrivalTime <span class="sc">+</span> SexParent <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                     FoodTreatment <span class="sc">:</span> SexParent <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                     FoodTreatment <span class="sc">:</span> ArrivalTime <span class="sc">+</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                     <span class="co">#offset(LogBroodSize) +  #Feel free to include</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                     (<span class="dv">1</span> <span class="sc">|</span> Nest),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> poisson,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> Owls)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Numerical results:</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: poisson  ( log )
Formula: 
NCalls ~ FoodTreatment + ArrivalTime + SexParent + FoodTreatment:SexParent +  
    FoodTreatment:ArrivalTime + (1 | Nest)
   Data: Owls

     AIC      BIC   logLik deviance df.resid 
  5011.4   5042.1  -2498.7   4997.4      592 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.4559 -1.7563 -0.6413  1.1770 11.1040 

Random effects:
 Groups Name        Variance Std.Dev.
 Nest   (Intercept) 0.235    0.4847  
Number of obs: 599, groups:  Nest, 27

Fixed effects:
                                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                          5.1698547  0.2926462  17.666   &lt;2e-16 ***
FoodTreatmentSatiated               -0.6540263  0.4686680  -1.396   0.1629    
ArrivalTime                         -0.1296994  0.0113051 -11.473   &lt;2e-16 ***
SexParentMale                       -0.0094526  0.0453669  -0.208   0.8349    
FoodTreatmentSatiated:SexParentMale  0.1297493  0.0704391   1.842   0.0655 .  
FoodTreatmentSatiated:ArrivalTime   -0.0004913  0.0192171  -0.026   0.9796    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) FdTrtS ArrvlT SxPrnM FTS:SP
FdTrtmntStt -0.545                            
ArrivalTime -0.938  0.570                     
SexParentMl -0.060  0.055 -0.038              
FdTrtmS:SPM  0.033 -0.049  0.024 -0.606       
FdTrtmnS:AT  0.539 -0.993 -0.573  0.004 -0.043</code></pre>
</div>
</div>
<p>For the Bayesian baboon models, the code to run the model is given later in the script, but it is more appropriately shown here. You can skip this part if you are not familiar with Bayesian methods as this might be more confusing than anything. The authors re-use an example from the course they teach and only provide the minimal code needed to run the model which makes it difficult to get the full picture. That part of the provided code lacks the model validation section, and provide functions (which I have placed in a separate file for simplicity) about which the authors say the reader should not “bother trying to understand”…). Still, let’s source those functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"scripts"</span>, <span class="st">"functions.R"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>One of the relevant question to the analysis, which is provided as a code comment (instead of being mentioned in step 1, as I think it should have been) is that Subordinates should prefer to groom more dominant animals earlier in the day. To look at this we need to subset the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>Monkeys_sub <span class="ot">&lt;-</span> Monkeys[Monkeys<span class="sc">$</span>SubordinateGrooms <span class="sc">==</span> <span class="st">"yes"</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we prepare the model data to run with JAGS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transfor the response variable:</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Monkeys_sub)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>Monkeys_sub<span class="sc">$</span>RD.scaled <span class="ot">&lt;-</span> (Monkeys_sub<span class="sc">$</span>RankDifference <span class="sc">*</span> (N <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.5</span>) <span class="sc">/</span> N</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A full explanation  of zero inflatedbeta models is provided in </span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Zuur's Beginner's Guide to Zero-Inflated Models with R' </span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># For MCMC it is essential to standardize continuous covariates</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>Mystd <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {(x <span class="sc">-</span> <span class="fu">mean</span>(x)) <span class="sc">/</span> <span class="fu">sd</span>(x)}</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>Monkeys_sub<span class="sc">$</span>Time.std        <span class="ot">&lt;-</span> <span class="fu">Mystd</span>(Monkeys_sub<span class="sc">$</span>Time)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>Monkeys_sub<span class="sc">$</span>Relatedness.std <span class="ot">&lt;-</span> <span class="fu">Mystd</span>(Monkeys_sub<span class="sc">$</span>Relatedness)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># JAGS coding</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create X matrix</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>Time.std <span class="sc">*</span> Relatedness.std <span class="sc">+</span> Relatedness.std <span class="sc">*</span> GroupSize,</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> Monkeys_sub)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Random effects:</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>reFocalGroomer  <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(Monkeys_sub<span class="sc">$</span>FocalGroomer))</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>NumFocalGroomer <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(Monkeys_sub<span class="sc">$</span>FocalGroomer))</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>reFocalHour  <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(Monkeys_sub<span class="sc">$</span>FocalHour))</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>NumFocalHour <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(Monkeys_sub<span class="sc">$</span>FocalHour))</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>reReceiver  <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(Monkeys_sub<span class="sc">$</span>Receiver))</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>NumReceiver <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(Monkeys_sub<span class="sc">$</span>Receiver))</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Put all data for JAGS in a list</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>JAGS.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Y            =</span> Monkeys_sub<span class="sc">$</span>RD.scaled,</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">N            =</span> <span class="fu">nrow</span>(Monkeys_sub),</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">X            =</span> X,</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">K            =</span> <span class="fu">ncol</span>(X),</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reFGroomer   =</span> reFocalGroomer,</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>                  <span class="at">NumFGroomer  =</span> NumFocalGroomer,</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reFHour      =</span> reFocalHour,</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>                  <span class="at">NumFHour     =</span> NumFocalHour,</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>                  <span class="at">reRec        =</span> reReceiver,</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>                  <span class="at">NumReceiver  =</span> NumReceiver</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(JAGS.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 10
 $ Y          : num [1:1178] 0.697 0.632 0.169 0.378 0.511 ...
 $ N          : int 1178
 $ X          : num [1:1178, 1:6] 1 1 1 1 1 1 1 1 1 1 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:1178] "1" "2" "3" "4" ...
  .. ..$ : chr [1:6] "(Intercept)" "Time.std" "Relatedness.std" "GroupSizesmall" ...
  ..- attr(*, "assign")= int [1:6] 0 1 2 3 4 5
  ..- attr(*, "contrasts")=List of 1
  .. ..$ GroupSize: chr "contr.treatment"
 $ K          : int 6
 $ reFGroomer : num [1:1178] 2 58 58 47 13 46 46 46 46 30 ...
 $ NumFGroomer: int 59
 $ reFHour    : num [1:1178] 1 2 2 3 4 5 5 5 5 6 ...
 $ NumFHour   : int 573
 $ reRec      : num [1:1178] 5 59 47 41 57 14 14 56 49 57 ...
 $ NumReceiver: int 59</code></pre>
</div>
</div>
<p>We then run the chains. I do not run the updates as they take too much time on my laptop, hence why the results might not be matching perfectly the reported numbers in the paper.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>jags_file_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"jags"</span>, <span class="st">"BetaRegmm.txt"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(jags_file_path)) {</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sink</span>(jags_file_path)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="st">    #Priors regression parameters, theta</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:K) { beta[i]  ~ dnorm(0, 0.0001) }</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="st">    theta ~ dunif(0, 20)</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="st">    #Priors random effects</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1: NumFGroomer) {a[i] ~ dnorm(0, tau.gr) }</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1: NumFHour)    {b[i] ~ dnorm(0, tau.fh) }</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1: NumReceiver) {c[i] ~ dnorm(0, tau.rc) }</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="st">    #Priors for the variances of the random effects</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="st">    tau.gr &lt;- 1 / (sigma.gr * sigma.gr)</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="st">    tau.fh &lt;- 1 / (sigma.fh * sigma.fh)</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="st">    tau.rc &lt;- 1 / (sigma.rc * sigma.rc)</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="st">    sigma.gr ~ dunif(0, 10)</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="st">    sigma.fh ~ dunif(0, 10)</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="st">    sigma.rc ~ dunif(0, 10)</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="st">    #######################</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="st">    #Likelihood</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="st">    for (i in 1:N){</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="st">      Y[i] ~ dbeta(shape1[i], shape2[i])</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="st">      shape1[i] &lt;- theta * pi[i]</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="st">      shape2[i] &lt;- theta * (1 - pi[i])</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="st">      logit(pi[i]) &lt;- eta[i] + a[reFGroomer[i]] + b[reFHour[i]] + c[reRec[i]]</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a><span class="st">      eta[i]       &lt;- inprod(beta[], X[i,])</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sink</span>()</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the initial values for the betas and sigma</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta  =</span> <span class="fu">rnorm</span>(<span class="fu">ncol</span>(X), <span class="dv">0</span>, <span class="fl">0.1</span>),</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> <span class="fu">runif</span>(<span class="dv">0</span>, <span class="dv">20</span>),</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma.gr =</span> <span class="fu">runif</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma.fh =</span> <span class="fu">runif</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma.rc =</span> <span class="fu">runif</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>  )  }</span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a><span class="co">#Parameters to estimate</span></span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"beta"</span>, <span class="st">"theta"</span>,</span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">"sigma.gr"</span>, <span class="st">"sigma.fh"</span>, <span class="st">"sigma.rc"</span>)</span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>model_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"jags"</span>, <span class="st">"J0.rds"</span>)</span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(model_path)) {</span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a>  J0 <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data =</span> JAGS.data,</span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a>             <span class="at">inits =</span> inits,</span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a>             <span class="at">parameters =</span> params,</span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a>             <span class="at">model.file =</span> jags_file_path,</span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a>             <span class="at">n.thin =</span> <span class="dv">10</span>,</span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a>             <span class="at">n.chains =</span> <span class="dv">3</span>,</span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a>             <span class="at">n.burnin =</span> <span class="dv">4000</span>,</span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a>             <span class="at">n.iter   =</span> <span class="dv">5000</span>)</span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(J0, model_path) </span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a>  J0 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(model_path)</span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Fast computer:</span></span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a><span class="co"># J1  &lt;- update(J0, n.iter = 10000, n.thin = 10)</span></span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a><span class="co"># J2  &lt;- update(J1, n.iter = 50000, n.thin = 10)</span></span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a><span class="co"># out &lt;- J2$BUGSoutput</span></span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> J0<span class="sc">$</span>BUGSoutput</span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 24
 $ n.chains       : int 3
 $ n.iter         : num 5000
 $ n.burnin       : num 4000
 $ n.thin         : num 10
 $ n.keep         : int 100
 $ n.sims         : int 300
 $ sims.array     : num [1:100, 1:3, 1:11] 0.298 0.327 0.282 0.217 0.246 ...
  ..- attr(*, "dimnames")=List of 3
  .. ..$ : NULL
  .. ..$ : NULL
  .. ..$ : chr [1:11] "beta[1]" "beta[2]" "beta[3]" "beta[4]" ...
 $ sims.list      :List of 6
  ..$ beta    : num [1:300, 1:6] 0.2293 0.2488 0.3311 0.0713 0.1399 ...
  ..$ deviance: num [1:300, 1] -1461 -1610 -1597 -1588 -1573 ...
  ..$ sigma.fh: num [1:300, 1] 0.197 0.325 0.34 0.264 0.281 ...
  ..$ sigma.gr: num [1:300, 1] 0.491 0.594 0.496 0.461 0.594 ...
  ..$ sigma.rc: num [1:300, 1] 0.585 0.603 0.553 0.545 0.484 ...
  ..$ theta   : num [1:300, 1] 11.8 12.4 12.9 12.7 13.3 ...
 $ sims.matrix    : num [1:300, 1:11] 0.2293 0.2488 0.3311 0.0713 0.1399 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : NULL
  .. ..$ : chr [1:11] "beta[1]" "beta[2]" "beta[3]" "beta[4]" ...
 $ summary        : num [1:11, 1:9] 0.33 -0.0503 -0.0394 -0.2878 0.0413 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:11] "beta[1]" "beta[2]" "beta[3]" "beta[4]" ...
  .. ..$ : chr [1:9] "mean" "sd" "2.5%" "25%" ...
 $ mean           :List of 6
  ..$ beta    : num [1:6(1d)] 0.33 -0.0503 -0.0394 -0.2878 0.0413 ...
  ..$ deviance: num [1(1d)] -1623
  ..$ sigma.fh: num [1(1d)] 0.326
  ..$ sigma.gr: num [1(1d)] 0.551
  ..$ sigma.rc: num [1(1d)] 0.542
  ..$ theta   : num [1(1d)] 13.3
 $ sd             :List of 6
  ..$ beta    : num [1:6(1d)] 0.1565 0.0224 0.0425 0.2546 0.0216 ...
  ..$ deviance: num [1(1d)] 59.3
  ..$ sigma.fh: num [1(1d)] 0.0422
  ..$ sigma.gr: num [1(1d)] 0.0714
  ..$ sigma.rc: num [1(1d)] 0.0618
  ..$ theta   : num [1(1d)] 0.877
 $ median         :List of 6
  ..$ beta    : num [1:6(1d)] 0.3129 -0.0499 -0.0399 -0.2867 0.0391 ...
  ..$ deviance: num [1(1d)] -1625
  ..$ sigma.fh: num [1(1d)] 0.332
  ..$ sigma.gr: num [1(1d)] 0.546
  ..$ sigma.rc: num [1(1d)] 0.539
  ..$ theta   : num [1(1d)] 13.2
 $ root.short     : chr [1:6] "beta" "deviance" "sigma.fh" "sigma.gr" ...
 $ long.short     :List of 6
  ..$ : int [1:6] 1 2 3 4 5 6
  ..$ : int 7
  ..$ : int 8
  ..$ : int 9
  ..$ : int 10
  ..$ : int 11
 $ dimension.short: num [1:6] 1 0 0 0 0 0
 $ indexes.short  :List of 6
  ..$ :List of 6
  .. ..$ : num 1
  .. ..$ : num 2
  .. ..$ : num 3
  .. ..$ : num 4
  .. ..$ : num 5
  .. ..$ : num 6
  ..$ : NULL
  ..$ : NULL
  ..$ : NULL
  ..$ : NULL
  ..$ : NULL
 $ last.values    :List of 3
  ..$ :List of 5
  .. ..$ beta    : num [1:6(1d)] 0.3831 -0.0217 0.0398 -0.3688 0.0303 ...
  .. ..$ deviance: num [1(1d)] -1560
  .. ..$ sigma.fh: num [1(1d)] 0.288
  .. ..$ sigma.gr: num [1(1d)] 0.546
  .. ..$ sigma.rc: num [1(1d)] 0.517
  ..$ :List of 5
  .. ..$ beta    : num [1:6(1d)] 0.04858 -0.06041 -0.00364 -0.02162 0.02057 ...
  .. ..$ deviance: num [1(1d)] -1507
  .. ..$ sigma.fh: num [1(1d)] 0.26
  .. ..$ sigma.gr: num [1(1d)] 0.541
  .. ..$ sigma.rc: num [1(1d)] 0.406
  ..$ :List of 5
  .. ..$ beta    : num [1:6(1d)] 0.1042 -0.041 -0.101 -0.2195 0.0534 ...
  .. ..$ deviance: num [1(1d)] -1573
  .. ..$ sigma.fh: num [1(1d)] 0.303
  .. ..$ sigma.gr: num [1(1d)] 0.537
  .. ..$ sigma.rc: num [1(1d)] 0.571
 $ program        : chr "jags"
 $ model.file     : chr "/home/vlucet/Documents/WILDLab/repos/ZuurIeno10steps/jags/BetaRegmm.txt"
 $ isDIC          : logi TRUE
 $ DICbyR         : logi TRUE
 $ pD             : num 1695
 $ DIC            : num 71.9
 - attr(*, "class")= chr "bugs"</code></pre>
</div>
</div>
<p>We process the results of the Bayesian model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess chain mixing (an indication of how well the model ran)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">MyBUGSChains</span>(out,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(<span class="fu">uNames</span>(<span class="st">"beta"</span>, K), <span class="st">"theta"</span>, <span class="st">"sigma.gr"</span>, <span class="st">"sigma.fh"</span>, <span class="st">"sigma.rc"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="10stepsRegression_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="step-7-validate-the-model" class="level3">
<h3 class="anchored" data-anchor-id="step-7-validate-the-model">Step 7: Validate the model</h3>
<p>What is validation? “<em>Model validation confirms that the model complies with underlying assumptions</em>.”</p>
<p>Regression models have assumptions (in particular about the structure of residuals) and the fore violation of those assumptions may lead to increase bias, type 1 error rate, etc. Residuals should be plotted against all variables (and time and space dimensions if applicable) and autocorellation should be modeled if applicable.</p>
<p>To get to the residuals and fitted values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>E1 <span class="ot">&lt;-</span> <span class="fu">resid</span>(M1, <span class="at">type =</span> <span class="st">"pearson"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>F1 <span class="ot">&lt;-</span> <span class="fu">fitted</span>(M1)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(E1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Named num [1:599] -1.19 -1.87 -1.87 -1.85 -1.85 ...
 - attr(*, "names")= chr [1:599] "1" "2" "3" "4" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(F1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Named num [1:599] 7.18 6.93 6.9 6.85 6.82 ...
 - attr(*, "names")= chr [1:599] "1" "2" "3" "4" ...</code></pre>
</div>
</div>
<p>In the context of the owl data, the authors describe finding a pattern of over dispersion by calculating an over dispersion metric:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the dispersion statistic</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (not counting random effects as parameters)</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>E1 <span class="ot">&lt;-</span> <span class="fu">resid</span>(M1, <span class="at">type =</span> <span class="st">"pearson"</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>N  <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Owls)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>p  <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">fixef</span>(M1)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(E1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (N <span class="sc">-</span> p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.439501</code></pre>
</div>
</div>
<p>Not in the paper, they also flag a potential issue with heterogeneity…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> F1,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> E1,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Fitted values"</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Pearson residuals"</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="10stepsRegression_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Building up to the next figure in the paper, we plot arrival time against those residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> Owls<span class="sc">$</span>ArrivalTime,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> E1,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Arrival time (h)"</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Pearson residuals"</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="10stepsRegression_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Suspecting a non-linear structure, the authors decide to fit a GAM on the residuals. As they write in the code “If the smoother is not significant, or if it explains a small amount of variation, then there are indeed no residual patterns.”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> <span class="fu">gam</span>(E1 <span class="sc">~</span> <span class="fu">s</span>(ArrivalTime), <span class="at">data =</span> Owls)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(T2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
E1 ~ s(ArrivalTime)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.01448    0.09185  -0.158    0.875

Approximate significance of smooth terms:
                 edf Ref.df     F  p-value    
s(ArrivalTime) 7.159  8.206 5.011 4.88e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.0615   Deviance explained = 7.27%
GCV = 5.1235  Scale est. = 5.0537    n = 599</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(T2)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="10stepsRegression_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now, we can reproduce the next figure in the paper. The authors used a plotting technique for the predictions which consists in creating a grid of arrival times to feed to the <code>predict</code> function. To this we add the smoother and its confidence interval, all of it using <code>ggplot2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>time_range <span class="ot">&lt;-</span> <span class="fu">range</span>(Owls<span class="sc">$</span>ArrivalTime)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>MyData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ArrivalTime =</span> <span class="fu">seq</span>(time_range[<span class="dv">1</span>], time_range[<span class="dv">2</span>], </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">length =</span> <span class="dv">100</span>))</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">predict</span>(T2, <span class="at">newdata =</span> MyData, <span class="at">se =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>MyData<span class="sc">$</span>mu   <span class="ot">&lt;-</span> P<span class="sc">$</span>fit</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>MyData<span class="sc">$</span>SeUp <span class="ot">&lt;-</span> P<span class="sc">$</span>fit <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> P<span class="sc">$</span>se</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>MyData<span class="sc">$</span>SeLo <span class="ot">&lt;-</span> P<span class="sc">$</span>fit <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> P<span class="sc">$</span>se</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>Owls<span class="sc">$</span>E1 <span class="ot">&lt;-</span> E1</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>p_M1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Arrival time  (h)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Pearson residuals"</span>) <span class="sc">+</span> </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span> </span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Owls,</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> ArrivalTime, <span class="at">y =</span> E1),</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> MyData,</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> ArrivalTime, <span class="at">y =</span> mu),</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> MyData,</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> ArrivalTime,</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> SeUp,</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> SeLo ),</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>p_M1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="10stepsRegression_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From this exploration of the residuals, the authors conclude that we should be using a GAMM instead…</p>
<p>A couple of notes: the authors mention in a figure caption that the smooth only explains 7% of the variation in the residuals, which as I understand it (maybe badly), is quite low. They also mention other factors that could be responsible for overdispersion: “a missing covariate, the relatively large number of zero observations (25%) or dependency within (or between) nests”. The pattern with arrival time seems quite clear, and I am left convinced it should be dealt with in the model. I am not left convinced that a complex GAMM would be the first answer, however.</p>
<p>Validation for the baboon bayesian model is not present in the code.</p>
</section>
<section id="step-8-interpret-and-present-the-numerical-output-of-the-model" class="level3">
<h3 class="anchored" data-anchor-id="step-8-interpret-and-present-the-numerical-output-of-the-model">Step 8: Interpret and present the numerical output of the model</h3>
<p>Interpreting complex regression results in R can be complicated, especially when it comes to interaction terms and how they change intercepts and slopes. The authors suggest to report the main results in a table: “estimated parameters, standard errors, t-values, R2 and the estimated variance”. For mixed effects models: report multiple variances, calculate intraclass correlation to derive the R2. For GAMs/GAMMs, make sure to report the effective df of smoothers.</p>
<p>The authors report the controversies around reporting p-values. They say: “Their interpretation is prone to abuse, and, for most of the frequentist techniques mentioned, <em>P</em>-values are approximate at best. They must be interpreted with care, and this should be emphasized in the paper. An alternative is to present 95% confidence intervals for the regression parameters and effect size estimates and their precision”.</p>
<p>Concerning the owl model, writing out the actual effects might help. Here I insert the next equation in the paper:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://besjournals.onlinelibrary.wiley.com/cms/asset/75975d41-4e84-4afe-9657-9529d9952eab/mee312577-math-0003.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Equation expanded for the owl model</figcaption>
</figure>
</div>
<p>The authors simply report the Fixed effects table from <code>summary(M1)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>M1_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(M1)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>M1_table <span class="ot">&lt;-</span> M1_sum<span class="sc">$</span>coefficients <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(M1_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                         Estimate Std. Error      z value
(Intercept)                          5.1698547275 0.29264624  17.66588463
FoodTreatmentSatiated               -0.6540262583 0.46866801  -1.39550010
ArrivalTime                         -0.1296994152 0.01130508 -11.47266482
SexParentMale                       -0.0094525874 0.04536692  -0.20835861
FoodTreatmentSatiated:SexParentMale  0.1297492849 0.07043915   1.84200531
FoodTreatmentSatiated:ArrivalTime   -0.0004913068 0.01921705  -0.02556619
                                        Pr(&gt;|z|)
(Intercept)                         7.679934e-70
FoodTreatmentSatiated               1.628651e-01
ArrivalTime                         1.809982e-30
SexParentMale                       8.349490e-01
FoodTreatmentSatiated:SexParentMale 6.547437e-02
FoodTreatmentSatiated:ArrivalTime   9.796034e-01</code></pre>
</div>
</div>
<p>In reports, these table came be outputted to a markdown table and nicely formatted.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(M1_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 40%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">z value</th>
<th style="text-align: right;">Pr(&gt;|z|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">5.1698547</td>
<td style="text-align: right;">0.2926462</td>
<td style="text-align: right;">17.6658846</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">FoodTreatmentSatiated</td>
<td style="text-align: right;">-0.6540263</td>
<td style="text-align: right;">0.4686680</td>
<td style="text-align: right;">-1.3955001</td>
<td style="text-align: right;">0.1628651</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ArrivalTime</td>
<td style="text-align: right;">-0.1296994</td>
<td style="text-align: right;">0.0113051</td>
<td style="text-align: right;">-11.4726648</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">SexParentMale</td>
<td style="text-align: right;">-0.0094526</td>
<td style="text-align: right;">0.0453669</td>
<td style="text-align: right;">-0.2083586</td>
<td style="text-align: right;">0.8349490</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FoodTreatmentSatiated:SexParentMale</td>
<td style="text-align: right;">0.1297493</td>
<td style="text-align: right;">0.0704391</td>
<td style="text-align: right;">1.8420053</td>
<td style="text-align: right;">0.0654744</td>
</tr>
<tr class="even">
<td style="text-align: left;">FoodTreatmentSatiated:ArrivalTime</td>
<td style="text-align: right;">-0.0004913</td>
<td style="text-align: right;">0.0192171</td>
<td style="text-align: right;">-0.0255662</td>
<td style="text-align: right;">0.9796034</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Alternatively, one can use a package designed to deal with tables specifically, such as <code>gtable</code> (for structured tables with tidy data), or more appropriately here, <code>stargazer</code> (to compare models) or <code>sjPlot</code>.</p>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we use the html for this report, and note the results='asis' code chunck </span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># options, but stargazer has other output format options</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(M1, <span class="at">type =</span> <span class="st">"html"</span>, <span class="at">flip =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<table style="text-align:center">
<tbody><tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
NCalls
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
FoodTreatmentSatiated
</td>
<td>
-0.654
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.469)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
ArrivalTime
</td>
<td>
-0.130<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.011)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SexParentMale
</td>
<td>
-0.009
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.045)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
FoodTreatmentSatiated:SexParentMale
</td>
<td>
0.130<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.070)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
FoodTreatmentSatiated:ArrivalTime
</td>
<td>
-0.0005
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.019)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
5.170<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.293)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
599
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-2,498.690
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
5,011.381
</td>
</tr>
<tr>
<td style="text-align:left">
Bayesian Inf. Crit.
</td>
<td>
5,042.147
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup><em>p&lt;0.1; <sup><strong></strong></sup><strong>p&lt;0.05; <sup></sup></strong></em>p&lt;0.01
</td>
</tr>

</tbody></table>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">NCalls</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Incidence Rate Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">175.89</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">99.11&nbsp;–&nbsp;312.13</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">FoodTreatment [Satiated]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.21&nbsp;–&nbsp;1.30</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.163</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">ArrivalTime</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.88</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.86&nbsp;–&nbsp;0.90</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SexParent [Male]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.91&nbsp;–&nbsp;1.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.835</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">FoodTreatment [Satiated]<br>× SexParent [Male]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.14</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.99&nbsp;–&nbsp;1.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.065</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">FoodTreatment [Satiated]<br>× ArrivalTime</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.00</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.96&nbsp;–&nbsp;1.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.980</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.16</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Nest</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.23</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.59</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Nest</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">27</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">599</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.267 / 0.699</td>
</tr>

</tbody></table>

</div>
</div>
<p>The values in the last equation are produced by expanding the correct values from the table into the formula. Note that here, “the overdispersion and nonlinear pattern in the Pearson residuals invalidate the results”.</p>
<p>For MCMC models, the same is applicable. Here is what the equation would look like for a model like the baboon data example (for large groups, as for small groups there need to be a correction, see the paper for the resulting equation):</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://besjournals.onlinelibrary.wiley.com/cms/asset/327ce41c-700f-4b62-b5e4-02b0f69494aa/mee312577-math-0004.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Expanded equation for baboon model</figcaption>
</figure>
</div>
<p>The table for this model is treated similarly with kable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># present output</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>OUT1 <span class="ot">&lt;-</span> <span class="fu">MyBUGSOutput</span>(out,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="fu">uNames</span>(<span class="st">"beta"</span>, K), <span class="st">"sigma.gr"</span>, <span class="st">"sigma.fh"</span>, <span class="st">"sigma.rc"</span>, <span class="st">"theta"</span>))</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(OUT1)[<span class="dv">1</span><span class="sc">:</span>K] <span class="ot">&lt;-</span> <span class="fu">colnames</span>(X)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(OUT1, <span class="at">digits =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                    mean       se        2.5%      97.5%
(Intercept)                     0.330026 0.156454  0.05525310  0.6221030
Time.std                       -0.050283 0.022368 -0.09657115 -0.0080435
Relatedness.std                -0.039357 0.042529 -0.11658754  0.0402774
GroupSizesmall                 -0.287839 0.254589 -0.81645269  0.1611966
Time.std:Relatedness.std        0.041279 0.021623  0.00014808  0.0831566
Relatedness.std:GroupSizesmall  0.252929 0.053244  0.14178199  0.3517761
sigma.gr                        0.551376 0.071424  0.42725554  0.6907920
sigma.fh                        0.326122 0.042196  0.22980833  0.4011921
sigma.rc                        0.541729 0.061770  0.43822784  0.6811514
theta                          13.253933 0.876666 11.65854514 15.0072451</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(OUT1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 41%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">se</th>
<th style="text-align: right;">2.5%</th>
<th style="text-align: right;">97.5%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.3300258</td>
<td style="text-align: right;">0.1564539</td>
<td style="text-align: right;">0.0552531</td>
<td style="text-align: right;">0.6221030</td>
</tr>
<tr class="even">
<td style="text-align: left;">Time.std</td>
<td style="text-align: right;">-0.0502832</td>
<td style="text-align: right;">0.0223680</td>
<td style="text-align: right;">-0.0965711</td>
<td style="text-align: right;">-0.0080435</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Relatedness.std</td>
<td style="text-align: right;">-0.0393575</td>
<td style="text-align: right;">0.0425290</td>
<td style="text-align: right;">-0.1165875</td>
<td style="text-align: right;">0.0402774</td>
</tr>
<tr class="even">
<td style="text-align: left;">GroupSizesmall</td>
<td style="text-align: right;">-0.2878393</td>
<td style="text-align: right;">0.2545893</td>
<td style="text-align: right;">-0.8164527</td>
<td style="text-align: right;">0.1611966</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Time.std:Relatedness.std</td>
<td style="text-align: right;">0.0412791</td>
<td style="text-align: right;">0.0216227</td>
<td style="text-align: right;">0.0001481</td>
<td style="text-align: right;">0.0831566</td>
</tr>
<tr class="even">
<td style="text-align: left;">Relatedness.std:GroupSizesmall</td>
<td style="text-align: right;">0.2529292</td>
<td style="text-align: right;">0.0532444</td>
<td style="text-align: right;">0.1417820</td>
<td style="text-align: right;">0.3517761</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sigma.gr</td>
<td style="text-align: right;">0.5513762</td>
<td style="text-align: right;">0.0714242</td>
<td style="text-align: right;">0.4272555</td>
<td style="text-align: right;">0.6907920</td>
</tr>
<tr class="even">
<td style="text-align: left;">sigma.fh</td>
<td style="text-align: right;">0.3261219</td>
<td style="text-align: right;">0.0421959</td>
<td style="text-align: right;">0.2298083</td>
<td style="text-align: right;">0.4011921</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sigma.rc</td>
<td style="text-align: right;">0.5417293</td>
<td style="text-align: right;">0.0617704</td>
<td style="text-align: right;">0.4382278</td>
<td style="text-align: right;">0.6811514</td>
</tr>
<tr class="even">
<td style="text-align: left;">theta</td>
<td style="text-align: right;">13.2539334</td>
<td style="text-align: right;">0.8766656</td>
<td style="text-align: right;">11.6585451</td>
<td style="text-align: right;">15.0072451</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>I am not aware of any packages for pretty printing of JAGS model output tables.</p>
</section>
<section id="step-9-create-a-visual-representation-of-the-model" class="level3">
<h3 class="anchored" data-anchor-id="step-9-create-a-visual-representation-of-the-model">Step 9: Create a visual representation of the model</h3>
<p>This is usually the main “results” figure: a visual plotting of the model in action. One should strive to avoid plotting redundant information while still showing the fitted values and the model variance.</p>
<p>Again, the authors remind owl GLMM is “overdispersed, and the residuals contained nonlinear patterns”, which could be improved with a GAMM with nonlinear time arrival effect (then, why not show that, instead of reminding us many times in the paper and the code how bad the analysis actually is). But let’s imagine the GLMM was sufficient and reproduce the next figure in the pap?er. The comments in the original code are quite useful here. I just modified the code to remove a warning.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A. Specify covariate values for predictions</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>MyData <span class="ot">&lt;-</span> <span class="fu">ddply</span>(Owls,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                .(SexParent, FoodTreatment),</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                summarize,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">ArrivalTime =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(ArrivalTime),</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">to =</span> <span class="fu">max</span>(ArrivalTime),</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">length =</span> <span class="dv">10</span>))</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co"># B. Create X matrix with expand.grid</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> FoodTreatment <span class="sc">+</span> ArrivalTime <span class="sc">+</span> SexParent <span class="sc">+</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>                    FoodTreatment<span class="sc">:</span>SexParent <span class="sc">+</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>                    FoodTreatment<span class="sc">:</span>ArrivalTime,</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> MyData)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co"># C. Calculate predicted values</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>MyData<span class="sc">$</span>eta <span class="ot">&lt;-</span> X <span class="sc">%*%</span> <span class="fu">fixef</span>(M1)</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>MyData<span class="sc">$</span>mu  <span class="ot">&lt;-</span> <span class="fu">exp</span>(MyData<span class="sc">$</span>eta)</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="co"># D. Calculate standard errors (SE) for predicted values</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="co"># SE of fitted values are given by the square root of</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="co"># the diagonal elements of: X * cov(betas) * t(X)</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>MyData<span class="sc">$</span>SE   <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(X <span class="sc">%*%</span> <span class="fu">vcov</span>(M1) <span class="sc">%*%</span> <span class="fu">t</span>(X)))</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>MyData<span class="sc">$</span>seup <span class="ot">&lt;-</span> <span class="fu">exp</span>(MyData<span class="sc">$</span>eta <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> MyData<span class="sc">$</span>SE)</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>MyData<span class="sc">$</span>selo <span class="ot">&lt;-</span> <span class="fu">exp</span>(MyData<span class="sc">$</span>eta <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> MyData<span class="sc">$</span>SE)</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a><span class="co"># E. Plot predicted values +/- 2* SE</span></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>p_fitted <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Arrival time (h)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Number of calls"</span>) <span class="sc">+</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Owls,</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> ArrivalTime, <span class="at">y =</span> NCalls),</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">01</span>),</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="fu">grey</span>(<span class="fl">0.2</span>),</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> MyData,</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> ArrivalTime,</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> mu)) <span class="sc">+</span></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> MyData,</span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> ArrivalTime,</span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> seup,</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> selo),</span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(SexParent <span class="sc">~</span> FoodTreatment,</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">"fixed"</span>) <span class="sc">+</span></span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span> </span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a>p_fitted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="10stepsRegression_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>For the baboon model, the authors recommends to plot the model fit in a way that highlights the interactions between the continuous and categorical covariate, as well as between the two continuous covariates. I prefer the paste the entire quote that justifies the 3D plot:</p>
<ul>
<li>The figure “shows two planes, one representing the small group and for the other representing the large group. The small group exhibited a positive effect of relatedness on rank differences early in the day and a negative effect later in the day, as well as a negative time effect for low relatedness values and a positive time effect for higher relatedness values. The large group shows a negative relatedness effect early in the day”.</li>
</ul>
<p>The code was written before R 4.0 and the breaking change concerning characters no longer being read as factors when loading the data, so we need to change another couple of things to get the expected behavior as well. Let’s get the predictions ready.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get the realisations of the betas</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>Beta.mcmc <span class="ot">&lt;-</span> out<span class="sc">$</span>sims.list<span class="sc">$</span>beta</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a grid of covariate values</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>time_range <span class="ot">&lt;-</span> <span class="fu">range</span>(Monkeys_sub<span class="sc">$</span>Time.std)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>relate_range <span class="ot">&lt;-</span> <span class="fu">range</span>(Monkeys_sub<span class="sc">$</span>Relatedness.std)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>MyData <span class="ot">&lt;-</span> </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand.grid</span>(<span class="at">Time.std =</span> <span class="fu">seq</span>(time_range[<span class="dv">1</span>], time_range[<span class="dv">2</span>], <span class="at">length =</span> <span class="dv">15</span>),</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">Relatedness.std =</span> <span class="fu">seq</span>(relate_range[<span class="dv">1</span>], relate_range[<span class="dv">2</span>], <span class="at">length =</span> <span class="dv">15</span>),</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">GroupSize =</span> <span class="fu">levels</span>(<span class="fu">as.factor</span>(Monkeys_sub<span class="sc">$</span>GroupSize)))</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the grid into a X matrix, and calculate the fitted</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="co"># values for each (!) MCMC iteration</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>Time.std <span class="sc">*</span> Relatedness.std <span class="sc">+</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>                    Relatedness.std <span class="sc">*</span> GroupSize,</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> MyData)</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>Betas <span class="ot">&lt;-</span> Beta.mcmc</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>eta   <span class="ot">&lt;-</span> X <span class="sc">%*%</span> <span class="fu">t</span>(Betas)</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>mu    <span class="ot">&lt;-</span> <span class="fu">exp</span>(eta) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(eta))</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">MyLinesStuff</span>(mu)</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(L) <span class="co">#Posterior mean, se and 95% CI for each of these covariate values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:450, 1:4] 0.651 0.644 0.637 0.63 0.622 ...
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : chr [1:4] "mean" "se" "2.5%" "97.5%"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Glue the results in L to the MyData object</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>MyData <span class="ot">&lt;-</span> <span class="fu">cbind</span>(MyData,L)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(MyData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   450 obs. of  7 variables:
 $ Time.std       : num  -2.25 -1.96 -1.66 -1.37 -1.07 ...
 $ Relatedness.std: num  -1.41 -1.41 -1.41 -1.41 -1.41 ...
 $ GroupSize      : Factor w/ 2 levels "large","small": 1 1 1 1 1 1 1 1 1 1 ...
 $ mean           : num  0.651 0.644 0.637 0.63 0.622 ...
 $ se             : num  0.0425 0.0417 0.041 0.0403 0.0397 ...
 $ 2.5%           : num  0.575 0.57 0.564 0.559 0.552 ...
 $ 97.5%          : num  0.73 0.72 0.711 0.702 0.693 ...</code></pre>
</div>
</div>
<p>The code to make figure 8 is not like in the paper.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In the paper we use a slighly different angle. Change</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the i value, or put a loop around this code in which i</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># runs form 1 to 1000.</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">70</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>p_3D <span class="ot">&lt;-</span> <span class="fu">wireframe</span>(mean <span class="sc">~</span> Time.std <span class="sc">+</span> Relatedness.std, </span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> MyData,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">group =</span> GroupSize,</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>                  <span class="co">#zlim = c(0,1),</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shade =</span> <span class="cn">TRUE</span>,</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scales =</span> <span class="fu">list</span>(<span class="at">arrows =</span> <span class="cn">FALSE</span>),</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">drape =</span> <span class="cn">TRUE</span>, </span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">colorkey =</span> <span class="cn">FALSE</span>,</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">screen =</span> <span class="fu">list</span>(<span class="at">z =</span> i, <span class="at">x =</span> <span class="sc">-</span><span class="dv">60</span> <span class="sc">-</span> i <span class="sc">/</span><span class="dv">5</span>))</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_3D)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="10stepsRegression_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>So let’s try and use a better solution. Both <code>rgl</code> and <code>plotly</code> are great for 3D plotting. Let’s give <code>rgl</code> a try.</p>
<div class="cell" data-webgl="true">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot3d</span>( </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> MyData<span class="sc">$</span>Relatedness.std, </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> MyData<span class="sc">$</span>mean, </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> MyData<span class="sc">$</span>Time.std, </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># col = data$color, </span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'s'</span>, </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">radius =</span> .<span class="dv">1</span>,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Relatedness std"</span>, <span class="at">zlab =</span> <span class="st">"Mean"</span>, <span class="at">xlab =</span> <span class="st">"Time.std"</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="co"># saveWidget(rglwidget(width = 520, height = 520), </span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co">#            file = here("widgets", "rgl_plot.html"),</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="co">#            libdir = "libs",</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="co">#            selfcontained = FALSE</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="rgl33119" style="width:100%;height:464px;" class="rglWebGL html-widget" role="img" aria-labelledby="rgl33119-aria"></div>
<script type="application/json" data-for="rgl33119">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmode":"modulate","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":7,"objects":{"13":{"id":13,"type":"spheres","material":{},"vertices":"0","colors":"1","radii":[[0.1000000014901161]],"centers":"2","ignoreExtent":false,"fastTransparency":true,"flags":32771},"15":{"id":15,"type":"text","material":{"lit":false,"margin":0,"floating":true,"edge":[0,1,1]},"vertices":"3","colors":"4","texts":[["Time.std"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"5","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"16":{"id":16,"type":"text","material":{"lit":false,"margin":1,"floating":true,"edge":[1,1,1]},"vertices":"6","colors":"7","texts":[["Relatedness std"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"8","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"17":{"id":17,"type":"text","material":{"lit":false,"margin":2,"floating":true,"edge":[1,1,1]},"vertices":"9","colors":"10","texts":[["Mean"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"11","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"11":{"id":11,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"10":{"id":10,"type":"background","material":{},"colors":"12","centers":"13","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines"},"colors":"14","centers":"15","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"14":{"id":14,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":"16","colors":"17","axes":{"mode":["pretty","pretty","pretty"],"step":[1,0.5,0.05000000074505806],"nticks":[5,5,5],"marklen":[15,15,15],"expand":[1.029999971389771,1.029999971389771,1.029999971389771]},"draw_front":true,"flags":32769},"7":{"id":7,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":7,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,13.43685436248779],"modelMatrix":[[0.722309410572052,0,0,0.1395807415246964],[0,0.3298090994358063,10.58385848999023,-5.5387864112854],[0,-0.9061430692672729,3.852209806442261,-15.32313442230225],[0,0,0,1]],"projMatrix":[[3.732050657272339,0,0,0],[0,3.732050657272339,0,0],[0,0,-3.863703489303589,-48.43830871582031],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201433256682,0.9396926207859085,0],[0,-0.9396926207859085,0.3420201433256682,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.722309410572052,0.9642972946166992,11.26310729980469],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-2.387810707092285,2.001326084136963,-1.517481923103333,1.770211577415466,0.3786487281322479,0.6601237058639526],"windowRect":[70,188,326,444],"family":"sans","font":1,"cex":1,"useFreeType":true,"fontname":"/home/vlucet/.cache/R/renv/cache/v5/R-4.3/x86_64-pc-linux-gnu/rgl/1.2.8/ebf0bdc2d3cddc603abf3a091d4a4d38/rgl/fonts/FreeSans.ttf","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[12,14,13,15,16,17,11],"subscenes":[],"flags":34067}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":672,"height":480,"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":450,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":2,"componentType":5126,"count":450,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":13,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":14,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":15,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5126,"count":18,"type":"VEC3"},{"bufferView":17,"componentType":5121,"count":1,"type":"VEC4"}],"bufferViews":[{"buffer":0,"byteLength":5400,"byteOffset":0},{"buffer":0,"byteLength":4,"byteOffset":5400},{"buffer":0,"byteLength":5400,"byteOffset":5404},{"buffer":0,"byteLength":12,"byteOffset":10804},{"buffer":0,"byteLength":4,"byteOffset":10816},{"buffer":0,"byteLength":12,"byteOffset":10820},{"buffer":0,"byteLength":12,"byteOffset":10832},{"buffer":0,"byteLength":4,"byteOffset":10844},{"buffer":0,"byteLength":12,"byteOffset":10848},{"buffer":0,"byteLength":12,"byteOffset":10860},{"buffer":0,"byteLength":4,"byteOffset":10872},{"buffer":0,"byteLength":12,"byteOffset":10876},{"buffer":0,"byteLength":16,"byteOffset":10888},{"buffer":0,"byteLength":3,"byteOffset":10904},{"buffer":0,"byteLength":4,"byteOffset":10907},{"buffer":0,"byteLength":3,"byteOffset":10911},{"buffer":0,"byteLength":216,"byteOffset":10916},{"buffer":0,"byteLength":4,"byteOffset":11132}],"buffers":[{"byteLength":11136,"bytes":"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\nAADAf2dmJj8AAAAB"}]},"context":{"shiny":false,"rmarkdown":null},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG) || defined(USE_ENVMAP)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n// USE_ENVMAP implies NEEDS_VNORMAL\n\n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n\n#ifdef USE_ENVMAP\n  vReflection = normalize(reflect(vPosition.xyz/vPosition.w, \n                        normalize(vNormal.xyz/vNormal.w)));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n\n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i])\n        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n\n// These calculations use the definitions from \n// https://docs.gl/gl3/glTexEnv\n\n#ifdef USE_ENVMAP\n    float m = 2.0 * sqrt(dot(vReflection, vReflection) + 2.0*vReflection.z + 1.0);\n    vec4 textureColor = texture2D(uSampler, vReflection.xy / m + vec2(0.5, 0.5));\n#else\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n#endif\n\n#ifdef TEXTURE_rgb\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(textureColor.rgb, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*vec4(textureColor.rgb, 1.);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb, lighteffect.a);\n#endif\n\n#endif //TEXTURE_rgb\n        \n#ifdef TEXTURE_rgba\n\n#ifdef TEXMODE_replace\n// already done\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*textureColor;\n#endif\n\n#ifdef TEXMODE_decal\n    textureColor = vec4((1. - textureColor.a)*lighteffect.rgb) +\n                     textureColor.a*textureColor.rgb, \n                     lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n    \n#endif //TEXTURE_rgba\n    \n#ifdef TEXTURE_alpha\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(lighteffect.rgb, textureColor.a);\n#endif \n\n#if defined(TEXMODE_modulate) || defined(TEXMODE_blend) || defined(TEXMODE_add)\n    textureColor = vec4(lighteffect.rgb, lighteffect.a*textureColor.a);\n#endif\n \n#endif\n    \n// The TEXTURE_luminance values are not from that reference    \n#ifdef TEXTURE_luminance\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, lighteffect.a);\n#endif\n\n#endif // TEXTURE_luminance\n \n    \n#ifdef TEXTURE_luminance_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, textureColor.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n\n#endif\n\n#endif // TEXTURE_luminance_alpha\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
</div>
</section>
<section id="step-10-simulate-from-the-model" class="level3">
<h3 class="anchored" data-anchor-id="step-10-simulate-from-the-model">Step 10: Simulate from the model</h3>
<p>In this section the authors simulate from the model and show that the model underestimates the amount of 0s.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Owls)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">simulate</span>(M1, <span class="dv">10000</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>zeros <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="dv">10000</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  zeros[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(gg[,i] <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">/</span> N</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">table</span>(zeros), </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">160</span> <span class="sc">/</span> N),</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Percentage of zeros"</span>,</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Frequency"</span>)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, .<span class="dv">10</span>, <span class="fl">0.15</span>, <span class="fl">0.20</span>, <span class="fl">0.25</span>),</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"5%"</span>, <span class="st">"10%"</span>, <span class="st">"15%"</span>, <span class="st">"20%"</span>, <span class="st">"25%"</span>))     </span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> <span class="fu">sum</span>(Owls<span class="sc">$</span>NCalls <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">/</span> N, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="10stepsRegression_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>They also mention the use of cross-validation and counterfactuals (“what ifs”).</p>
<p>I found that simulation could have been introduced earlier: simulating specific pattern in the data to make sure our understanding of the model is accurate (a la statistical rethinking).</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>