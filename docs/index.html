<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Zuur &amp; Ieno’s 10 steps</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Zuur &amp; Ieno’s 10 steps</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#step-1-state-appropriate-questions" id="toc-step-1-state-appropriate-questions" class="nav-link active" data-scroll-target="#step-1-state-appropriate-questions">Step 1: State appropriate questions</a></li>
  <li><a href="#step-2-visualize-the-experimental-design" id="toc-step-2-visualize-the-experimental-design" class="nav-link" data-scroll-target="#step-2-visualize-the-experimental-design">Step 2: Visualize the experimental design</a></li>
  <li><a href="#step-3-conduct-data-exploration" id="toc-step-3-conduct-data-exploration" class="nav-link" data-scroll-target="#step-3-conduct-data-exploration">Step 3: Conduct data exploration</a></li>
  <li><a href="#step-4-identify-the-dependency-structure-in-the-data" id="toc-step-4-identify-the-dependency-structure-in-the-data" class="nav-link" data-scroll-target="#step-4-identify-the-dependency-structure-in-the-data">Step 4: Identify the dependency structure in the data</a></li>
  <li><a href="#step-5-present-the-statistical-model" id="toc-step-5-present-the-statistical-model" class="nav-link" data-scroll-target="#step-5-present-the-statistical-model">Step 5: Present the statistical model</a></li>
  <li><a href="#step-6-fit-the-model" id="toc-step-6-fit-the-model" class="nav-link" data-scroll-target="#step-6-fit-the-model">Step 6: Fit the model</a></li>
  <li><a href="#step-7-validate-the-model" id="toc-step-7-validate-the-model" class="nav-link" data-scroll-target="#step-7-validate-the-model">Step 7: Validate the model</a></li>
  <li><a href="#step-8-interpret-and-present-the-numerical-output-of-the-model" id="toc-step-8-interpret-and-present-the-numerical-output-of-the-model" class="nav-link" data-scroll-target="#step-8-interpret-and-present-the-numerical-output-of-the-model">Step 8: Interpret and present the numerical output of the model</a></li>
  <li><a href="#step-9-create-a-visual-representation-of-the-model" id="toc-step-9-create-a-visual-representation-of-the-model" class="nav-link" data-scroll-target="#step-9-create-a-visual-representation-of-the-model">Step 9: Create a visual representation of the model</a></li>
  <li><a href="#step-10-simulate-from-the-model" id="toc-step-10-simulate-from-the-model" class="nav-link" data-scroll-target="#step-10-simulate-from-the-model">Step 10: Simulate from the model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Zuur &amp; Ieno’s 10 steps</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This website in a reproducible exploration of “<a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.12577">A protocol for conducting and presenting results of regression-type analyses</a>” by Alain F. Zuur, and Elena N. Ieno.</p>
<p>The 10 steps are all first presented in figure 1 of the paper:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://besjournals.onlinelibrary.wiley.com/cms/asset/17c3d76c-f2e6-4e2a-a117-581a303cdaef/mee312577-fig-0001-m.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">The 10 steps</figcaption>
</figure>
</div>
<p>The focus of the 10 steps on on linear modelling of the type <strong>GLM, GLMM</strong> etc and uses R although it generalizes to other languages.</p>
<section id="accessing-data-and-code-for-reproducibility" class="level4">
<h4 class="anchored" data-anchor-id="accessing-data-and-code-for-reproducibility">Accessing data and code for reproducibility</h4>
<p>The paper provides data and code on Dryad but is not set up for interactive report-style reproducibility with package versioning (see the end of this section for a note about package age). To fix that, I used a quarto document with <code>renv</code> to produce this website. In order to reproduce the analysis here, you can clone <a href="https://github.com/VLucet/ZuurIeno10steps">the repository</a> in <a href="https://happygitwithr.com/new-github-first#new-rstudio-project-via-git">RStudio</a>, install the <a href="https://rstudio.github.io/renv/articles/renv.html"><code>renv</code></a> package, run <code>renv::restore()</code> and you should be good to go for running the quarto notebook!</p>
<p>In order to access the data and code, we would ideally use a package like <a href="https://github.com/ropensci/rdryad"><code>rdryad</code></a> to do so, but I have been getting nowhere with it. It is probably broken as it is soon to be superseded by the <a href="https://github.com/ropenscilabs/deposits"><code>deposits</code></a> package. If I forget to update this website with the latest <a href="https://github.com/ropenscilabs/deposits/issues/41"><code>deposits</code> API</a>, feel free the <a href="https://github.com/VLucet/ZuurIeno10steps/issues">file an issue</a>.</p>
<p>In the meantime, let’s download the files one by one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the file urls and destination files names &amp; names</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>base_dryad_url <span class="ot">&lt;-</span> <span class="st">"https://datadryad.org/stash/downloads/file_stream/"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>file_url_list <span class="ot">&lt;-</span> <span class="fu">paste0</span>(base_dryad_url, <span class="fu">c</span>(<span class="dv">37547</span><span class="sc">:</span><span class="dv">37550</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>files_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"monkeys.txt"</span>, <span class="st">"owls.txt"</span>, <span class="st">"oystercatchers.txt"</span>, <span class="st">"zurr_iena_2016.R"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>files_paths_list <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"data/"</span>, <span class="dv">3</span>), <span class="st">"scripts/"</span>), files_names)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># If the file exists already, do not download it</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>ret <span class="ot">&lt;-</span> <span class="fu">mapply</span>(\(file_url, file_path) {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) <span class="fu">download.file</span>(file_url, <span class="at">destfile =</span>  file_path)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>}, file_url_list, files_paths_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can take a look at the code in the scripts directory, we will be copying code from there into this document. Now, let’s load the data properly before we get anything else done.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at /home/vlucet/Documents/WILDLab/repos/ZuurIeno10steps</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Owls <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"owls.txt"</span>), </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dec =</span> <span class="st">"."</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Owls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Nest"               "Xcoord"             "Ycoord"            
 [4] "FoodTreatment"      "SexParent"          "ArrivalTime"       
 [7] "SiblingNegotiation" "BroodSize"          "NegPerChick"       
[10] "Date"               "Day"                "Month"             </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Owls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   599 obs. of  12 variables:
 $ Nest              : chr  "AutavauxTV" "AutavauxTV" "AutavauxTV" "AutavauxTV" ...
 $ Xcoord            : int  556216 556216 556216 556216 556216 556216 556216 556216 556216 556216 ...
 $ Ycoord            : int  188756 188756 188756 188756 188756 188756 188756 188756 188756 188756 ...
 $ FoodTreatment     : chr  "Deprived" "Deprived" "Deprived" "Deprived" ...
 $ SexParent         : chr  "Male" "Male" "Male" "Male" ...
 $ ArrivalTime       : num  22.2 22.5 22.6 22.6 22.6 ...
 $ SiblingNegotiation: int  4 2 2 2 2 18 18 3 3 3 ...
 $ BroodSize         : int  5 5 5 5 5 5 5 5 5 5 ...
 $ NegPerChick       : num  0.8 0.4 0.4 0.4 0.4 3.6 3.6 0.6 0.6 0.6 ...
 $ Date              : chr  "12/07/97" "12/07/97" "12/07/97" "12/07/97" ...
 $ Day               : int  12 12 12 12 12 12 12 12 12 12 ...
 $ Month             : int  7 7 7 7 7 7 7 7 7 7 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Owls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Nest Xcoord Ycoord FoodTreatment SexParent ArrivalTime
1 AutavauxTV 556216 188756      Deprived      Male       22.25
2 AutavauxTV 556216 188756      Deprived      Male       22.53
3 AutavauxTV 556216 188756      Deprived      Male       22.56
4 AutavauxTV 556216 188756      Deprived      Male       22.61
5 AutavauxTV 556216 188756      Deprived      Male       22.65
6 AutavauxTV 556216 188756      Deprived      Male       22.76
  SiblingNegotiation BroodSize NegPerChick     Date Day Month
1                  4         5         0.8 12/07/97  12     7
2                  2         5         0.4 12/07/97  12     7
3                  2         5         0.4 12/07/97  12     7
4                  2         5         0.4 12/07/97  12     7
5                  2         5         0.4 12/07/97  12     7
6                 18         5         3.6 12/07/97  12     7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Monkeys <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"monkeys.txt"</span>), </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Monkeys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "SubordinateGrooms" "DominantGrooms"    "RankDifference"   
 [4] "Relatedness"       "GroomSymmetry"     "Time"             
 [7] "FocalHour"         "FocalGroomer"      "Receiver"         
[10] "GroupSize"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Monkeys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1674 obs. of  10 variables:
 $ SubordinateGrooms: chr  "yes" "yes" "yes" "yes" ...
 $ DominantGrooms   : chr  "no" "yes" "yes" "no" ...
 $ RankDifference   : num  0.697 0.632 0.169 0.378 0.511 ...
 $ Relatedness      : num  0.224 0.682 0.707 0.291 0.453 ...
 $ GroomSymmetry    : int  1 1 0 1 1 1 0 1 1 1 ...
 $ Time             : num  4.19 5.6 6.16 6.98 2.85 ...
 $ FocalHour        : int  71 72 72 73 74 75 75 75 75 75 ...
 $ FocalGroomer     : chr  "ade" "vic" "vic" "pre" ...
 $ Receiver         : chr  "ban" "yao" "pre" "nai" ...
 $ GroupSize        : chr  "large" "large" "large" "large" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Monkeys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  SubordinateGrooms DominantGrooms RankDifference Relatedness GroomSymmetry
1               yes             no      0.6969321   0.2238303             1
2               yes            yes      0.6324555   0.6823489             1
3               yes            yes      0.1690309   0.7071068             0
4               yes             no      0.3779645   0.2913760             1
5               yes            yes      0.5107539   0.4529901             1
6               yes            yes      0.2948839   0.4539824             1
      Time FocalHour FocalGroomer Receiver GroupSize
1 4.186111        71          ade      ban     large
2 5.601667        72          vic      yao     large
3 6.164167        72          vic      pre     large
4 6.976111        73          pre      nai     large
5 2.850556        74          dys      ver     small
6 8.605278        75          pox      ecz     small</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>OC <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"oystercatchers.txt"</span>), </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dec =</span> <span class="st">"."</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(OC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ShellLength" "Month"       "FeedingType" "FeedingPlot"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(OC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   197 obs. of  4 variables:
 $ ShellLength: num  1.9 2.16 2.17 2.34 2.2 2.2 1.92 2.11 2.17 2.41 ...
 $ Month      : chr  "Dec" "Dec" "Dec" "Dec" ...
 $ FeedingType: chr  "Hammerers" "Hammerers" "Stabbers" "Hammerers" ...
 $ FeedingPlot: chr  "B" "B" "B" "B" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(OC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ShellLength Month FeedingType FeedingPlot
1        1.90   Dec   Hammerers           B
2        2.16   Dec   Hammerers           B
3        2.17   Dec    Stabbers           B
4        2.34   Dec   Hammerers           B
5        2.20   Dec    Stabbers           B
6        2.20   Dec   Hammerers           B</code></pre>
</div>
</div>
<p>Finally, the load the required packages. Packages <code>maptools</code> and <code>rgdal</code> are deprecated as far as I can tell, and <code>sp</code> is just not recommendable for forward compatibility in 2024. We will attempt to update the spatial code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Necessary packages</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)  </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Recommended by the authors but outdated</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># library(maptools)</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># library(sp)</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rgdal)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-1-state-appropriate-questions" class="level3">
<h3 class="anchored" data-anchor-id="step-1-state-appropriate-questions">Step 1: State appropriate questions</h3>
<p>The key idea is to have the salient question of the analysis in mind at the start, and formulate them properly. The example here is a study on the “vocal behavior of barn owl siblings” with a N = 28. Number of calls is sampled with microphone and the hypothesis is that food availability will influence that. Half the nests get extra food (treatment: satiated) and the other half is starved (treatment: deprived ; surprisingly no control?).</p>
<p>The 3 covariates are <em>time</em>, <em>food treatment (satiated or deprived)</em> and <em>sex of parent.</em> The question is :</p>
<ul>
<li>Does the relationship between sibling negotiation and sex of the parent differ with food treatment, and does the effect of time on sibling negotiation differ with food treatment?</li>
</ul>
<p>Note that the question contains the 3 terms and expected interactions.</p>
<p>The authors warn against breaking down the questions into smaller questions such as “Is there an effect of sex of the parent?”, as “A potential problem with this approach is that the residuals of one model may show patterns when compared with the covariates not used in that model, which invalidates the model assumptions.”</p>
<p>I find this a little surprising because I was taught to build simple models before complex ones, and would naturally work with simpler single covariate models first. The middle ground is probably where the first model you build is a result of a reasoning around the “simplest DAG”.</p>
</section>
<section id="step-2-visualize-the-experimental-design" class="level3">
<h3 class="anchored" data-anchor-id="step-2-visualize-the-experimental-design">Step 2: Visualize the experimental design</h3>
</section>
<section id="step-3-conduct-data-exploration" class="level3">
<h3 class="anchored" data-anchor-id="step-3-conduct-data-exploration">Step 3: Conduct data exploration</h3>
</section>
<section id="step-4-identify-the-dependency-structure-in-the-data" class="level3">
<h3 class="anchored" data-anchor-id="step-4-identify-the-dependency-structure-in-the-data">Step 4: Identify the dependency structure in the data</h3>
</section>
<section id="step-5-present-the-statistical-model" class="level3">
<h3 class="anchored" data-anchor-id="step-5-present-the-statistical-model">Step 5: Present the statistical model</h3>
</section>
<section id="step-6-fit-the-model" class="level3">
<h3 class="anchored" data-anchor-id="step-6-fit-the-model">Step 6: Fit the model</h3>
</section>
<section id="step-7-validate-the-model" class="level3">
<h3 class="anchored" data-anchor-id="step-7-validate-the-model">Step 7: Validate the model</h3>
</section>
<section id="step-8-interpret-and-present-the-numerical-output-of-the-model" class="level3">
<h3 class="anchored" data-anchor-id="step-8-interpret-and-present-the-numerical-output-of-the-model">Step 8: Interpret and present the numerical output of the model</h3>
</section>
<section id="step-9-create-a-visual-representation-of-the-model" class="level3">
<h3 class="anchored" data-anchor-id="step-9-create-a-visual-representation-of-the-model">Step 9: Create a visual representation of the model</h3>
</section>
<section id="step-10-simulate-from-the-model" class="level3">
<h3 class="anchored" data-anchor-id="step-10-simulate-from-the-model">Step 10: Simulate from the model</h3>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>